<?xml version="1.0" encoding="utf-8"?>
<odoo>
	<data>
        <template id="website_googletagmanager_assets" name="website_googletagmanager_assets" inherit_id="web.webclient_script">
            <xpath expr="." position="inside">
                <t t-set="google_tag_manager_key" t-value="env['ir.config_parameter'].sudo().get_param('google_tag_manager_key')" />
                <t t-if="google_tag_manager_key">
                    <!-- Google Tag Manager -->
                    <script>
                        (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&amp;l='+l:'';j.async=true;j.src=
                        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                        })(window,document,'script','dataLayer','<t t-esc="google_tag_manager_key"/>');
                    </script>
                    <!-- End Google Tag Manager -->
                </t>
            </xpath>     
        </template>
        <template id="website_googletagmanager_web_layout" name="website_googletagmanager_web_layout" inherit_id="web.layout">
            <xpath expr="//body" position="replace">
                <body t-att-class="body_classname">
                    <t t-set="google_tag_manager_key" t-value="env['ir.config_parameter'].sudo().get_param('google_tag_manager_key')" />
                    <t t-if="google_tag_manager_key">
                        <!-- Google Tag Manager (noscript) -->
                        <noscript><iframe t-att-src="'https://www.googletagmanager.com/ns.html?id='+google_tag_manager_key" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
                        <!-- End Google Tag Manager (noscript) -->                    
                    </t>
                    <t t-raw="0"/>
                </body>
            </xpath>     
        </template>                
	</data>
</odoo>
